# NFR — Требования безопасности (Quiz Builder)

| ID     | Название                           | Описание                                                                 | Метрика/Порог                                  | Проверка (чем/где)                          | Компонент   | Приоритет |
|--------|------------------------------------|--------------------------------------------------------------------------|------------------------------------------------|---------------------------------------------|-------------|-----------|
| NFR-01 | Хранение паролей                   | Пароли только в виде хэшей Argon2id                                      | t=3, m=256MB, p=1                              | Конфиг/код + unit-тест                      | auth        | High      |
| NFR-02 | Токены JWT                         | Подпись HS256; секрет ≥32 байт; TTL access                               | exp ≤ 15m                                     | Unit-тест разбор exp                        | auth        | High      |
| NFR-03 | Лимит логинов                      | Брутфорс ограничен                                                       | ≤5 попыток/мин на IP/username → 429            | E2E/нагрузочный тест                        | auth        | High      |
| NFR-04 | Отсутствие IDOR                    | CRUD квизов/вопросов — только владелец/админ                             | 100% защищённых эндпоинтов                     | Контрактные тесты                           | api/quizzes | High      |
| NFR-05 | Единый формат ошибок               | Все ошибки JSON: {"error":{code,message,details?}}                       | 100% 4xx/5xx через обработчики                 | Pytest (errors, 422/404/403)                | api         | High      |
| NFR-06 | Валидация пагинации                | limit/offset валидируются                                                | 1 ≤ limit ≤ 100, offset ≥ 0                    | Pytest (query params)                       | api         | Medium    |
| NFR-07 | Уязвимости зависимостей            | High/Critical устраняются оперативно                                     | Age ≤ 7 дней                                   | CI: pip-audit/Dependabot                    | build       | High      |
| NFR-08 | Секреты и ключи                    | Нет секретов в Git; SECRET_KEY из env; ротация                           | Ротация ≤ 90 дней                              | gitleaks (CI) + policy                      | platform    | Medium    |
| NFR-09 | Логи и трассировка                 | Один лог на запрос, request_id; аудит auth-событий                       | Покрытие 100% маршрутов auth                   | Интеграционный тест логов                   | logging     | Medium    |
| NFR-10 | Доступность API                    | Доступность публичных эндпоинтов                                         | SLA ≥ 99.5%/мес                                | Uptime мониторинг                           | platform    | Medium    |
| NFR-11 | Производительность p95             | Время ответа ключевых операций                                           | p95: GET /quizzes ≤ 250ms @ 50 RPS; login ≤ 350ms @ 20 RPS | Нагрузочный тест                           | api/auth    | Medium    |
| NFR-12 | CORS/TLS/заголовки                 | CORS доверенным Origin; HTTPS; HSTS                                      | 100% prod-трафика по TLS; корректные заголовки | Конфиг/сканер заголовков                    | platform    | Medium    |
