# ADR-002: Безопасные загрузки (magic bytes, лимит размера, канонизация путей)
Дата: 2025-09-22
Статус: Accepted

## Context
Нужно безопасно принимать изображения: защита от подмены MIME, больших файлов, traversal/симлинков. Альтернативы: доверять Content-Type, использовать внешние библиотеки.

## Decision
Проверяем magic bytes (PNG/JPEG), лимит размера 5 MB, имя файла — UUID с корректным расширением, база — реальный каталог, запрет симлинков у родителей.

## Consequences
+ Снижение риска RCE/DoS/утечек; простая реализация.
− Поддерживаем явный список форматов.

## Links
- NFR-07
- F1/F2, R1
- tests/test_upload_secure.py::test_secure_save_too_big
