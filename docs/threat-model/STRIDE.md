# STRIDE — Угрозы и контроли (Quiz Builder)

| Поток/Элемент | Угроза (S/T/R/I/D/E) | Описание угрозы | Контроль | Ссылка на NFR | Проверка/Артефакт |
|---------------|-----------------------|------------------|----------|---------------|-------------------|
| F1 /auth      | S (Spoofing)          | Брутфорс/подбор паролей | Лимит логинов, Argon2id, возможный lockout | NFR-01, NFR-03 | e2e негативные тесты; нагрузочный сценарий |
| F1 /auth      | T (Tampering)         | MITM без TLS, подмена трафика | HTTPS + HSTS; запрет HTTP | NFR-12 | проверка заголовков/сканер security headers |
| F1 /auth      | I (Info Disclosure)   | Утечка подробностей ошибок учётных записей | Унифицированные ошибки без PII | NFR-05 | pytest контракт ошибок |
| F2 /api       | E (Elevation of Priv.)| IDOR: доступ к чужим ресурсам | Owner-only guard, проверки owner_id/role=admin | NFR-04 | контрактные тесты на чужие ресурсы |
| F2 /api       | R (Repudiation)       | Нет трассировки действий | request_id, аудит auth-событий | NFR-09 | интеграционный тест логов |
| F2 /api       | I (Info Disclosure)   | Утечка JWT/ответов через CORS | CORS только доверенным origin, не логировать токены | NFR-12, NFR-09 | конфиг CORS; проверка логов |
| F2 /api       | D (Denial of Service) | Шторм запросов к публичным эндпоинтам | Rate-limit на IP/токен, пагинация | NFR-06, NFR-03 | e2e лимиты/пагинация |
| F3 Data       | T (Tampering)         | Подмена данных (квизы/ответы) | Ролевые проверки, тесты целостности | NFR-04 | contract + unit |
| F3 Data       | I (Info Disclosure)   | Утечка PII/результатов | Least privilege, изоляция БД, отсутствие PII в логах | NFR-09 | ревью логов/конфиг БД |
| F5 Secret     | I (Info Disclosure)   | Утечка SECRET_KEY из репо | env-переменная, gitleaks, ротация ключа | NFR-08 | gitleaks в CI; политика ротации |
| F5 Secret     | T (Tampering)         | Подмена секрета → подмена токенов | Разделение секретов по окружениям; ротация | NFR-08 | чек-лист DevOps; ревью конфигов |
| F6 Logs       | I (Info Disclosure)   | Логи содержат PII/секреты | Маскирование/не логировать чувствительное, формат ошибок | NFR-05, NFR-09 | проверка логов; pytest ошибок |
